<?php //controlador agenda
    function pegarDadosJson(){
        $contatos = file_get_contents("contatos.json", true); //guardando os resultados       
				$contatos = json_decode($contatos, true); // convertendo para um array
       
			 return $contatos; //retorna o valor para a variavel contatos 
    }        
		
		
		//função para cadastrar um contato    function cadastrar($nome, $email, $telefone){
        $contatos = pegarDadosJson();
				
       $contato = [          
			 
			 "id"       => uniqid(), //gerar um id novo e diferente de todos cada vez que atualizar           
			 "nome"     => $nome,          
			 "email"    => $email,          
			 "telefone" => $telefone      
			 ];
			 
       array_push($contatos, $contato); //push é adicionar um novo contato a lista de contatos.
       $dados_json = json_encode($contatos, JSON_PRETTY_PRINT); //arrumar na hora de executar
       
			 //atualizar o conteudo do arquivo      
			 file_put_contents("contatos.json", $dados_json);
      
			
			header('Location: index.php'); //redireciona para index.php   }     
			 
			 
			 //função para excluir um contato - fim
			 
			 //função para pegar um contato
    			
			function pegarContatos(){
			
        		$contatos = file_get_contents("contatos.json", true); //Ele pega as arquivos do contatos e guarda o resultado        
				$contatos = json_decode($contatos, true); // Ele pega os valores guardados e converte pra um array
        
				return $contatos; //retorna o valor para a variavel contatos 
    }   
		
		//função para pegar um contato - fim
		
   		  //	função para buscar um contato        
     
     	function buscarContato($contatoBuscado){

            $contatos = file_get_contents("contatos.json", true); //guardando os resultados            
	    $contatos = json_decode($contatos, true); // convertendo para um array

            if ($contatoBuscado != null) {
                $contatosEncontrados = [];
		
                foreach ($contatos as $contato) {                    
		if ($contato['Nome'] == $contatoBuscado) {
                        return $contatosEncontrados; //retorna o valor para a variavel
			}               
			
	}
             //função para buscar um contato - fim            
	     
	     
	     
	     
	      //GERENCIAMENTO DE ROTAS    
	      if ($_GET['acao'] == 'cadastrar'){
	      cadastrar($_POST['Nome'], $_POST['Email'], $_POST['Telefone']);    
	      
	      }elseif ($_GET['acao'] == 'excluir'){         
	      excluirContato($_GET['id']);     
	      
	      } elseif ($_GET['acao'] == 'editar'){         
	      salvarContatoEditado($_GET['id']);     
	      
	      }elseif ($_GET['acao'] == 'buscar'){         
	      buscarContato($_GET['Nome']);     }
		
